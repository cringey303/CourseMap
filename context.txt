Project Context Generated on 12/09/2025 01:11:24

========================================
FILE: app.json
========================================
{
  "expo": {
    "name": "CourseMap",
    "slug": "CourseMap",
    "version": "1.0.0",
    "orientation": "portrait",
    "icon": "./assets/images/icon.png",
    "scheme": "coursemap",
    "userInterfaceStyle": "automatic",
    "newArchEnabled": true,
    "ios": {
      "supportsTablet": true
    },
    "android": {
      "adaptiveIcon": {
        "backgroundColor": "#E6F4FE",
        "foregroundImage": "./assets/images/android-icon-foreground.png",
        "backgroundImage": "./assets/images/android-icon-background.png",
        "monochromeImage": "./assets/images/android-icon-monochrome.png"
      },
      "edgeToEdgeEnabled": true,
      "predictiveBackGestureEnabled": false
    },
    "web": {
      "output": "static",
      "favicon": "./assets/images/favicon.png"
    },
    "plugins": [
      "expo-router",
      [
        "expo-splash-screen",
        {
          "image": "./assets/images/splash-icon.png",
          "imageWidth": 200,
          "resizeMode": "contain",
          "backgroundColor": "#ffffff",
          "dark": {
            "backgroundColor": "#000000"
          }
        }
      ]
    ],
    "experiments": {
      "typedRoutes": true,
      "reactCompiler": true
    }
  }
}


========================================
FILE: eslint.config.js
========================================
// https://docs.expo.dev/guides/using-eslint/
const { defineConfig } = require('eslint/config');
const expoConfig = require('eslint-config-expo/flat');

module.exports = defineConfig([
  expoConfig,
  {
    ignores: ['dist/*'],
  },
]);


========================================
FILE: expo-env.d.ts
========================================
/// <reference types="expo/types" />

// NOTE: This file should not be edited and should be in your git ignore

========================================
FILE: package.json
========================================
{
  "name": "coursemap",
  "main": "expo-router/entry",
  "version": "1.0.0",
  "scripts": {
    "start": "expo start",
    "reset-project": "node ./scripts/reset-project.js",
    "android": "expo start --android",
    "ios": "expo start --ios",
    "web": "expo start --web",
    "lint": "expo lint"
  },
  "dependencies": {
    "@expo/vector-icons": "^15.0.3",
    "@react-native-async-storage/async-storage": "2.2.0",
    "@react-navigation/bottom-tabs": "^7.4.0",
    "@react-navigation/elements": "^2.6.3",
    "@react-navigation/native": "^7.1.8",
    "@supabase/supabase-js": "^2.87.0",
    "expo": "~54.0.27",
    "expo-av": "~16.0.8",
    "expo-constants": "~18.0.11",
    "expo-font": "~14.0.10",
    "expo-haptics": "~15.0.8",
    "expo-image": "~3.0.11",
    "expo-image-picker": "~17.0.9",
    "expo-linear-gradient": "^15.0.8",
    "expo-linking": "~8.0.10",
    "expo-location": "^19.0.8",
    "expo-router": "~6.0.17",
    "expo-secure-store": "^15.0.8",
    "expo-splash-screen": "~31.0.12",
    "expo-status-bar": "~3.0.9",
    "expo-symbols": "~1.0.8",
    "expo-system-ui": "~6.0.9",
    "expo-web-browser": "~15.0.10",
    "firebase": "^12.6.0",
    "react": "19.1.0",
    "react-dom": "19.1.0",
    "react-native": "0.81.5",
    "react-native-gesture-handler": "~2.28.0",
    "react-native-maps": "1.20.1",
    "react-native-reanimated": "~4.1.1",
    "react-native-safe-area-context": "~5.6.0",
    "react-native-screens": "~4.16.0",
    "react-native-url-polyfill": "^3.0.0",
    "react-native-web": "~0.21.0",
    "react-native-worklets": "0.5.1"
  },
  "devDependencies": {
    "@types/react": "~19.1.0",
    "eslint": "^9.25.0",
    "eslint-config-expo": "~10.0.0",
    "typescript": "~5.9.2"
  },
  "private": true
}


========================================
FILE: README.md
========================================
# CourseMap

This is an [Expo](https://expo.dev) project created with [`create-expo-app`](https://www.npmjs.com/package/create-expo-app).

## Get started

1. Install dependencies

   ```bash
   npm install
   ```

2. Start the app

   ```bash
   npx expo start
   ```

In the output, you'll find options to open the app in a

- [development build](https://docs.expo.dev/develop/development-builds/introduction/)
- [Android emulator](https://docs.expo.dev/workflow/android-studio-emulator/)
- [iOS simulator](https://docs.expo.dev/workflow/ios-simulator/)
- [Expo Go](https://expo.dev/go), a limited sandbox for trying out app development with Expo

You can start developing by editing the files inside the **app** directory. This project uses [file-based routing](https://docs.expo.dev/router/introduction).

## Get a fresh project

When you're ready, run:

```bash
npm run reset-project
```

This command will move the starter code to the **app-example** directory and create a blank **app** directory where you can start developing.

## Learn more

To learn more about developing your project with Expo, look at the following resources:

- [Expo documentation](https://docs.expo.dev/): Learn fundamentals, or go into advanced topics with our [guides](https://docs.expo.dev/guides).
- [Learn Expo tutorial](https://docs.expo.dev/tutorial/introduction/): Follow a step-by-step tutorial where you'll create a project that runs on Android, iOS, and the web.

## Join the community

Join our community of developers creating universal apps.

- [Expo on GitHub](https://github.com/expo/expo): View our open source platform and contribute.
- [Discord community](https://chat.expo.dev): Chat with Expo users and ask questions.


========================================
FILE: supabase_setup.sql
========================================
-- Create Profiles Table
CREATE TABLE profiles (
  id UUID REFERENCES auth.users NOT NULL PRIMARY KEY,
  role TEXT CHECK (role IN ('coach', 'coxswain')),
  team_name TEXT
);

-- Turn on RLS for Profiles
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;

-- Allow users to view their own profile
CREATE POLICY "Users can view own profile" ON profiles
  FOR SELECT USING (auth.uid() = id);

-- Allow users to update their own profile
CREATE POLICY "Users can update own profile" ON profiles
  FOR UPDATE USING (auth.uid() = id);

-- Create Submissions Table
CREATE TABLE submissions (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES profiles(id) NOT NULL,
  media_url TEXT NOT NULL,
  notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc'::text, now()) NOT NULL
);

-- Turn on RLS for Submissions
ALTER TABLE submissions ENABLE ROW LEVEL SECURITY;

-- Allow Coxswains to view only their own submissions
CREATE POLICY "Coxswains can view own submissions" ON submissions
  FOR SELECT USING (
    auth.uid() = user_id
  );

-- Allow Coaches to view all submissions
CREATE POLICY "Coaches can view all submissions" ON submissions
  FOR SELECT USING (
    EXISTS (
      SELECT 1 FROM profiles
      WHERE profiles.id = auth.uid() AND profiles.role = 'coach'
    )
  );

-- Allow Coxswains to insert their own submissions
CREATE POLICY "Coxswains can insert own submissions" ON submissions
  FOR INSERT WITH CHECK (
    auth.uid() = user_id
  );

-- Storage Setup: create a public bucket 'course-media'
INSERT INTO storage.buckets (id, name, public) VALUES ('course-media', 'course-media', true);

-- Policy to allow authenticated uploads to 'course-media'
CREATE POLICY "Authenticated users can upload media"
ON storage.objects FOR INSERT TO authenticated WITH CHECK (
  bucket_id = 'course-media' AND auth.uid() = owner
);

-- Policy to allow public to view media (since it's a public bucket, but good to be explicit/safe)
CREATE POLICY "Public can view media"
ON storage.objects FOR SELECT TO public USING (
  bucket_id = 'course-media'
);


========================================
FILE: tsconfig.json
========================================
{
  "extends": "expo/tsconfig.base",
  "compilerOptions": {
    "strict": true,
    "paths": {
      "@/*": [
        "./*"
      ]
    }
  },
  "include": [
    "**/*.ts",
    "**/*.tsx",
    ".expo/types/**/*.ts",
    "expo-env.d.ts"
  ]
}


========================================
FILE: app/_layout.tsx
========================================
import { ThemeProvider } from '@/components/ThemeContext';
import { supabase } from '@/lib/supabase';
import { Session } from '@supabase/supabase-js';
import { Stack, useRouter, useSegments } from 'expo-router';
import { StatusBar } from 'expo-status-bar';
import { useEffect, useState } from 'react';
import 'react-native-reanimated';

export const unstable_settings = {
  anchor: '(tabs)',
};

export default function RootLayout() {
  const [session, setSession] = useState<Session | null>(null);
  const [initialized, setInitialized] = useState(false);
  const segments = useSegments();
  const router = useRouter();

  useEffect(() => {
    // Check initial session
    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
      setInitialized(true);
    });

    // Listen for changes
    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {
      setSession(session);
    });

    return () => subscription.unsubscribe();
  }, []);

  useEffect(() => {
    if (!initialized) return;

    const inTabsGroup = segments[0] === '(tabs)';

    if (session && !inTabsGroup) {
      // If logged in and NOT in tabs, go to tabs
      router.replace('/(tabs)');
    } else if (!session && inTabsGroup) {
      // If NOT logged in and trying to access tabs, go to welcome
      router.replace('/welcome');
    }
  }, [session, initialized, segments]);

  return (
    <ThemeProvider>
      <Stack screenOptions={{ headerShown: false }}>
        <Stack.Screen name="(tabs)" />
        <Stack.Screen name="welcome" />
        <Stack.Screen name="modal" options={{ presentation: 'modal', title: 'Modal' }} />
      </Stack>
      <StatusBar style="auto" />
    </ThemeProvider>
  );
}


========================================
FILE: app/modal.tsx
========================================
import { Link } from 'expo-router';
import { StyleSheet } from 'react-native';

import { ThemedText } from '@/components/themed-text';
import { ThemedView } from '@/components/themed-view';

export default function ModalScreen() {
  return (
    <ThemedView style={styles.container}>
      <ThemedText type="title">This is a modal</ThemedText>
      <Link href="/" dismissTo style={styles.link}>
        <ThemedText type="link">Go to home screen</ThemedText>
      </Link>
    </ThemedView>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: 'center',
    justifyContent: 'center',
    padding: 20,
  },
  link: {
    marginTop: 15,
    paddingVertical: 15,
  },
});


========================================
FILE: app/welcome.tsx
========================================
import AuthForm from '@/components/AuthForm';
import { useTheme } from '@/components/ThemeContext';
import { LinearGradient } from 'expo-linear-gradient';
import React from 'react';
import { StyleSheet, Text, View } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';

export default function WelcomeScreen() {
    const { colors } = useTheme();

    return (
        <View style={styles.container}>
            {/* Fallback Gradient since Image Generation failed - intended to be ImageBackground */}
            <LinearGradient
                colors={['#003366', '#001a33']}
                style={styles.background}
            >
                <SafeAreaView style={styles.safeArea}>
                    <View style={styles.header}>
                        <Text style={styles.title}>CourseMap</Text>
                        <Text style={styles.subtitle}>Track your rowing progress</Text>
                    </View>

                    <View style={styles.formContainer}>
                        <AuthForm />
                    </View>
                </SafeAreaView>
            </LinearGradient>
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
    },
    background: {
        flex: 1,
        justifyContent: 'center',
    },
    safeArea: {
        flex: 1,
        justifyContent: 'center',
        paddingHorizontal: 20,
    },
    header: {
        alignItems: 'center',
        marginBottom: 50,
    },
    title: {
        fontSize: 48,
        fontWeight: '800',
        color: '#FFFFFF',
        marginBottom: 10,
        textShadowColor: 'rgba(0, 0, 0, 0.3)',
        textShadowOffset: { width: 0, height: 2 },
        textShadowRadius: 4,
    },
    subtitle: {
        fontSize: 18,
        color: '#E0E0E0',
        fontWeight: '500',
    },
    formContainer: {
        backgroundColor: 'rgba(255, 255, 255, 0.1)', // Glass effect container for form
        padding: 20,
        borderRadius: 20,
        borderWidth: 1,
        borderColor: 'rgba(255, 255, 255, 0.2)',
    },
});


========================================
FILE: app/(tabs)/_layout.tsx
========================================
import { Tabs } from 'expo-router';
import React from 'react';

import { HapticTab } from '@/components/haptic-tab';
import { useTheme } from '@/components/ThemeContext';
import { IconSymbol } from '@/components/ui/icon-symbol';

export default function TabLayout() {
  const { colors } = useTheme();

  return (
    <Tabs
      screenOptions={{
        tabBarActiveTintColor: colors.tabIconSelected,
        tabBarInactiveTintColor: colors.tabIconDefault,
        tabBarStyle: {
          backgroundColor: colors.background,
          borderTopColor: colors.border,
        },
        headerShown: false,
        tabBarButton: HapticTab,
      }}>
      <Tabs.Screen
        name="index"
        options={{
          title: 'Map',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="map.fill" color={color} />,
        }}
      />
      <Tabs.Screen
        name="upload"
        options={{
          title: 'Upload',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="arrow.up.doc.fill" color={color} />,
        }}
      />
      <Tabs.Screen
        name="profile"
        options={{
          title: 'Profile',
          tabBarIcon: ({ color }) => <IconSymbol size={28} name="person.fill" color={color} />,
        }}
      />
    </Tabs>
  );
}


========================================
FILE: app/(tabs)/index.tsx
========================================
import { useTheme } from '@/components/ThemeContext';
import { IconSymbol } from '@/components/ui/icon-symbol';
import * as Location from 'expo-location';
import React, { useEffect, useState } from 'react';
import { StyleSheet, Text, View } from 'react-native';
import MapView, { Marker, Polyline, PROVIDER_DEFAULT } from 'react-native-maps';
import { useSafeAreaInsets } from 'react-native-safe-area-context';

// Head of the Charles (HOCR) Course
const HOCR_COURSE = [
    { latitude: 42.3546, longitude: -71.1065 }, // Start: BU Boathouse
    { latitude: 42.3562, longitude: -71.1128 }, // Magazine Beach
    { latitude: 42.3582, longitude: -71.1175 }, // Riverside
    { latitude: 42.3605, longitude: -71.1185 }, // River St Bridge
    { latitude: 42.3620, longitude: -71.1205 }, // Western Ave Bridge
    { latitude: 42.3635, longitude: -71.1235 }, // Weeks Footbridge (Turn 1)
    { latitude: 42.3655, longitude: -71.1265 }, // Anderson Bridge
    { latitude: 42.3685, longitude: -71.1315 }, // Approaching Eliot
    { latitude: 42.3705, longitude: -71.1370 }, // Eliot Bridge (The Big Turn)
    { latitude: 42.3715, longitude: -71.1410 }, // Belmont Hill
    { latitude: 42.3735, longitude: -71.1460 }, // Northeastern
    { latitude: 42.3742, longitude: -71.1485 }, // Finish: Herter Park
];

export default function MapScreen() {
    const [location, setLocation] = useState<Location.LocationObject | null>(null);
    const insets = useSafeAreaInsets();
    const { colors, isDark } = useTheme();

    useEffect(() => {
        (async () => {
            let { status } = await Location.requestForegroundPermissionsAsync();
            if (status === 'granted') {
                let loc = await Location.getCurrentPositionAsync({});
                setLocation(loc);
            }
        })();
    }, []);

    const initialRegion = {
        latitude: 42.366,
        longitude: -71.135,
        latitudeDelta: 0.05,
        longitudeDelta: 0.05,
    };

    return (
        <View style={styles.container}>
            <MapView
                style={styles.map}
                initialRegion={initialRegion}
                showsUserLocation={true}
                provider={PROVIDER_DEFAULT}
                tintColor={colors.navy}
                // CRITICAL FIX: Push map controls down by the top safe area inset
                mapPadding={{ top: insets.top, bottom: 0, left: 0, right: 0 }}
            >
                <Polyline
                    coordinates={HOCR_COURSE}
                    strokeColor={colors.navy}
                    strokeWidth={4}
                    lineDashPattern={[1]}
                />
                <Marker
                    coordinate={HOCR_COURSE[0]}
                    title="Start"
                    description="BU Boathouse"
                    pinColor={colors.navy}
                />
                <Marker
                    coordinate={HOCR_COURSE[HOCR_COURSE.length - 1]}
                    title="Finish"
                    description="Herter Park"
                    pinColor={colors.red}
                />
            </MapView>

            {/* GLASSMORPHISM OVERLAY */}
            <View style={[styles.overlayWrapper, { bottom: 30 + insets.bottom }]}>
                <View style={[styles.glassCard, { backgroundColor: colors.glass, borderColor: isDark ? '#333' : 'rgba(255,255,255,0.4)' }]}>
                    <View style={styles.cardHeader}>
                        <View style={[styles.iconContainer, { backgroundColor: colors.navy }]}>
                            <IconSymbol name="map.fill" size={20} color={'#FFFFFF'} />
                        </View>
                        <View>
                            <Text style={[styles.courseName, { color: colors.text }]}>Head of the Charles</Text>
                            <Text style={[styles.location, { color: colors.icon }]}>Boston, MA</Text>
                        </View>
                    </View>

                    <View style={styles.cardStats}>
                        <View style={styles.statItem}>
                            <Text style={[styles.statValue, { color: colors.text }]}>4.8km</Text>
                            <Text style={[styles.statLabel, { color: colors.icon }]}>Distance</Text>
                        </View>
                        <View style={[styles.divider, { backgroundColor: colors.border }]} />
                        <View style={styles.statItem}>
                            <Text style={[styles.statValue, { color: colors.text }]}>Upstream</Text>
                            <Text style={[styles.statLabel, { color: colors.icon }]}>Direction</Text>
                        </View>
                    </View>
                </View>
            </View>
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
    },
    map: {
        width: '100%',
        height: '100%',
    },
    overlayWrapper: {
        position: 'absolute',
        left: 20,
        right: 20,
        alignItems: 'center',
    },
    glassCard: {
        width: '100%',
        borderRadius: 24,
        padding: 20,
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 10 },
        shadowOpacity: 0.15,
        shadowRadius: 20,
        elevation: 10,
        borderWidth: 1,
    },
    cardHeader: {
        flexDirection: 'row',
        alignItems: 'center',
        marginBottom: 20,
    },
    iconContainer: {
        width: 40,
        height: 40,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
        marginRight: 12,
    },
    courseName: {
        fontSize: 18,
        fontWeight: 'bold',
    },
    location: {
        fontSize: 14,
    },
    cardStats: {
        flexDirection: 'row',
        justifyContent: 'space-around',
        alignItems: 'center',
    },
    statItem: {
        alignItems: 'center',
    },
    statValue: {
        fontSize: 18,
        fontWeight: '700',
    },
    statLabel: {
        fontSize: 12,
        marginTop: 2,
        textTransform: 'uppercase',
        letterSpacing: 0.5,
    },
    divider: {
        width: 1,
        height: 30,
    },
});


========================================
FILE: app/(tabs)/profile.tsx
========================================
import { useTheme } from '@/components/ThemeContext';
import { IconSymbol } from '@/components/ui/icon-symbol';
import { supabase } from '@/lib/supabase';
import { Session } from '@supabase/supabase-js';
import { useFocusEffect } from 'expo-router';
import { useCallback, useEffect, useState } from 'react';
import { FlatList, RefreshControl, StyleSheet, Switch, Text, TouchableOpacity, View } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';

type Submission = {
    id: string;
    media_url: string;
    notes: string;
    created_at: string;
    user_id: string;
};

export default function ProfileScreen() {
    const { colors, isDark, setTheme, theme } = useTheme();
    const [session, setSession] = useState<Session | null>(null);
    const [loading, setLoading] = useState(true);

    // Profile Data
    const [submissions, setSubmissions] = useState<Submission[]>([]);
    const [role, setRole] = useState<string>('MEMBER');

    useEffect(() => {
        supabase.auth.getSession().then(({ data: { session } }) => {
            setSession(session);
            setLoading(false);
        });

        supabase.auth.onAuthStateChange((_event, session) => {
            setSession(session);
        });
    }, []);

    const fetchProfileData = async () => {
        if (!session?.user) return;
        try {
            setLoading(true);
            const { data: profile } = await supabase
                .from('profiles')
                .select('role')
                .eq('id', session.user.id)
                .single();
            if (profile?.role) setRole(profile.role.toUpperCase());

            const { data: subs, error } = await supabase
                .from('submissions')
                .select('*')
                .order('created_at', { ascending: false });
            if (!error && subs) setSubmissions(subs);
        } catch (e) {
            console.log('Error fetching data', e);
        } finally {
            setLoading(false);
        }
    };

    useFocusEffect(
        useCallback(() => {
            if (session) fetchProfileData();
        }, [session])
    );

    const handleSignOut = async () => {
        await supabase.auth.signOut();
    };

    const toggleTheme = () => {
        const nextTheme = theme === 'light' ? 'dark' : 'light';
        setTheme(nextTheme);
    };

    // --- RENDER LOGIN ---
    // --- RENDER PROFILE ---

    // --- RENDER PROFILE ---
    const renderHeader = () => (
        <View style={styles.headerContainer}>
            <View style={styles.topRow}>
                <Text style={[styles.title, { color: colors.text }]}>Profile</Text>
                <View style={styles.settingsRow}>
                    <Text style={{ color: colors.text, marginRight: 8 }}>{isDark ? 'Dark' : 'Light'}</Text>
                    <Switch value={isDark} onValueChange={toggleTheme} />
                </View>
            </View>

            <View style={[styles.roleBadge, { backgroundColor: colors.navy }]}>
                <Text style={styles.roleText}>{role}</Text>
            </View>

            <View style={[styles.statsContainer, { backgroundColor: colors.card }]}>
                <View style={styles.statBlock}>
                    <Text style={[styles.statNumber, { color: colors.text }]}>{submissions.length}</Text>
                    <Text style={[styles.statLabel, { color: colors.icon }]}>Uploads</Text>
                </View>
                <View style={[styles.statDivider, { backgroundColor: colors.border }]} />
                <View style={styles.statBlock}>
                    <Text style={[styles.statNumber, { color: colors.text }]}>A</Text>
                    <Text style={[styles.statLabel, { color: colors.icon }]}>Team</Text>
                </View>
                <View style={[styles.statDivider, { backgroundColor: colors.border }]} />
                <View style={styles.statBlock}>
                    <Text style={[styles.statNumber, { color: colors.text }]}>12</Text>
                    <Text style={[styles.statLabel, { color: colors.icon }]}>Days</Text>
                </View>
            </View>

            <TouchableOpacity onPress={handleSignOut} style={{ alignSelf: 'center', marginBottom: 20 }}>
                <Text style={{ color: colors.red, fontWeight: 'bold' }}>Sign Out</Text>
            </TouchableOpacity>

            <Text style={[styles.sectionTitle, { color: colors.text }]}>Recent History</Text>
        </View>
    );

    return (
        <SafeAreaView style={[styles.safeArea, { backgroundColor: colors.background }]}>
            <FlatList
                data={submissions}
                keyExtractor={(item) => item.id}
                refreshControl={<RefreshControl refreshing={loading} onRefresh={fetchProfileData} tintColor={colors.text} />}
                ListHeaderComponent={renderHeader}
                ListEmptyComponent={
                    <View style={styles.emptyContainer}>
                        <IconSymbol name="video.slash" size={40} color={colors.icon} />
                        <Text style={[styles.emptyText, { color: colors.icon }]}>No submissions found.</Text>
                    </View>
                }
                contentContainerStyle={styles.listContent}
                renderItem={({ item }) => (
                    <View style={[styles.card, { backgroundColor: colors.card, shadowColor: isDark ? '#000' : '#000' }]}>
                        <View style={styles.cardLeft}>
                            <View style={[styles.iconPlaceholder, { backgroundColor: colors.navy }]}>
                                <IconSymbol name="video.fill" size={24} color={'#FFF'} />
                            </View>
                        </View>
                        <View style={styles.cardCenter}>
                            <Text style={[styles.cardTitle, { color: colors.text }]}>Practice Submission</Text>
                            <Text style={[styles.cardDate, { color: colors.icon }]}>{new Date(item.created_at).toLocaleDateString()}</Text>
                            {item.notes ? <Text style={[styles.cardNotes, { color: colors.icon }]} numberOfLines={1}>{item.notes}</Text> : null}
                        </View>
                        <View style={styles.cardRight}>
                            <IconSymbol name="chevron.right" size={20} color={colors.icon} />
                        </View>
                    </View>
                )}
            />
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    safeArea: {
        flex: 1,
    },
    listContent: {
        padding: 20,
        paddingBottom: 40,
    },
    // AUTH STYLES
    authContainer: {
        flex: 1,
        justifyContent: 'center',
        padding: 20,
    },
    authTitle: {
        fontSize: 32,
        fontWeight: 'bold',
        textAlign: 'center',
        marginBottom: 10,
    },
    authSubtitle: {
        textAlign: 'center',
        marginBottom: 40,
        fontSize: 16,
    },
    input: {
        height: 50,
        borderRadius: 12,
        borderWidth: 1,
        paddingHorizontal: 15,
        marginBottom: 15,
        fontSize: 16,
    },
    authButtons: {
        marginTop: 20,
        gap: 15,
    },
    primaryButton: {
        height: 50,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
    },
    buttonText: {
        color: '#FFF',
        fontSize: 16,
        fontWeight: 'bold',
    },
    secondaryButton: {
        height: 50,
        justifyContent: 'center',
        alignItems: 'center',
    },
    secondaryButtonText: {
        fontSize: 16,
        fontWeight: '600',
    },
    // PROFILE HEADER
    headerContainer: {
        marginBottom: 20,
        alignItems: 'center',
    },
    topRow: {
        width: '100%',
        flexDirection: 'row',
        justifyContent: 'space-between',
        alignItems: 'center',
        marginBottom: 10,
    },
    settingsRow: {
        flexDirection: 'row',
        alignItems: 'center',
    },
    title: {
        fontSize: 34,
        fontWeight: '800',
    },
    roleBadge: {
        paddingHorizontal: 16,
        paddingVertical: 6,
        borderRadius: 20,
        marginBottom: 24,
    },
    roleText: {
        color: '#FFF',
        fontWeight: '600',
        fontSize: 14,
        letterSpacing: 0.5,
    },
    statsContainer: {
        flexDirection: 'row',
        borderRadius: 16,
        paddingVertical: 16,
        width: '100%',
        marginBottom: 30,
        justifyContent: 'space-evenly',
        alignItems: 'center',
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.1,
        shadowRadius: 10,
        elevation: 2,
    },
    statBlock: {
        alignItems: 'center',
    },
    statNumber: {
        fontSize: 20,
        fontWeight: 'bold',
    },
    statLabel: {
        fontSize: 12,
        fontWeight: '500',
        marginTop: 4,
    },
    statDivider: {
        width: 1,
        height: '60%',
    },
    sectionTitle: {
        alignSelf: 'flex-start',
        fontSize: 22,
        fontWeight: '700',
        marginBottom: 10,
    },
    // CARD STYLES
    card: {
        flexDirection: 'row',
        alignItems: 'center',
        borderRadius: 16,
        padding: 16,
        marginBottom: 12,
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.1,
        shadowRadius: 8,
        elevation: 2,
    },
    cardLeft: {
        marginRight: 16,
    },
    iconPlaceholder: {
        width: 50,
        height: 50,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
    },
    cardCenter: {
        flex: 1,
        justifyContent: 'center',
    },
    cardTitle: {
        fontSize: 16,
        fontWeight: '600',
        marginBottom: 2,
    },
    cardDate: {
        fontSize: 13,
    },
    cardNotes: {
        fontSize: 13,
        marginTop: 2,
        fontStyle: 'italic',
    },
    cardRight: {
        marginLeft: 10,
    },
    emptyContainer: {
        alignItems: 'center',
        paddingVertical: 40,
    },
    emptyText: {
        marginTop: 10,
        fontSize: 16,
    },
});


========================================
FILE: app/(tabs)/upload.tsx
========================================
import { IconSymbol } from '@/components/ui/icon-symbol';
import { supabase } from '@/lib/supabase';
import * as ImagePicker from 'expo-image-picker';
import { router } from 'expo-router';
import { useState } from 'react';
import { ActivityIndicator, Alert, Image, StyleSheet, Text, TouchableOpacity, View } from 'react-native';
import { SafeAreaView } from 'react-native-safe-area-context';

// COLORS
import { useTheme } from '@/components/ThemeContext';

export default function UploadScreen() {
    const { colors } = useTheme();
    const [uploading, setUploading] = useState(false);
    const [videoUri, setVideoUri] = useState<string | null>(null);
    const [videoAsset, setVideoAsset] = useState<ImagePicker.ImagePickerAsset | null>(null);

    const pickVideo = async () => {
        try {
            const result = await ImagePicker.launchImageLibraryAsync({
                mediaTypes: ['videos'],
                allowsEditing: true,
                quality: 1,
            });

            if (!result.canceled && result.assets && result.assets.length > 0) {
                setVideoAsset(result.assets[0]);
                setVideoUri(result.assets[0].uri);
            }
        } catch (e) {
            Alert.alert('Error picking video');
        }
    };

    const removeVideo = () => {
        setVideoUri(null);
        setVideoAsset(null);
    };

    const handleUpload = async () => {
        if (!videoAsset) return;

        try {
            setUploading(true);

            const response = await fetch(videoAsset.uri);
            const arrayBuffer = await response.arrayBuffer();

            const fileName = `${Date.now()}_${Math.random()}.mov`;
            const { data: uploadData, error: uploadError } = await supabase.storage
                .from('course-media')
                .upload(fileName, arrayBuffer, {
                    contentType: videoAsset.mimeType || 'video/quicktime',
                });

            if (uploadError) throw uploadError;

            const { data: publicUrlData } = supabase.storage
                .from('course-media')
                .getPublicUrl(fileName);

            const { data: { user } } = await supabase.auth.getUser();

            if (user) {
                const { error: dbError } = await supabase
                    .from('submissions')
                    .insert({
                        user_id: user.id,
                        media_url: publicUrlData.publicUrl,
                        notes: 'Uploaded via app',
                    });
                if (dbError) throw dbError;
            }

            Alert.alert('Success', 'Video uploaded successfully!');
            router.push('/(tabs)/profile');
            removeVideo(); // Reset

        } catch (error) {
            console.error(error);
            Alert.alert('Error', 'Upload failed. Check console.');
        } finally {
            setUploading(false);
        }
    };

    return (
        <SafeAreaView style={[styles.container, { backgroundColor: colors.background }]}>
            <View style={styles.header}>
                <Text style={[styles.title, { color: colors.text }]}>Upload Footage</Text>
                <Text style={[styles.subtitle, { color: colors.icon }]}>Upload footage for coach analysis</Text>
            </View>

            <View style={styles.content}>
                {/* DROP ZONE OR PREVIEW */}
                {!videoUri ? (
                    <TouchableOpacity
                        style={[styles.dropZone, { backgroundColor: colors.card, borderColor: colors.border }]}
                        onPress={pickVideo}
                    >
                        <IconSymbol name="cloud.upload.fill" size={50} color={colors.navy} />
                        <Text style={[styles.dropText, { color: colors.text }]}>Tap to select race footage</Text>
                        <Text style={[styles.dropSubText, { color: colors.icon }]}>(Max 500MB)</Text>
                    </TouchableOpacity>
                ) : (
                    <View style={[styles.previewContainer, { backgroundColor: colors.card, shadowColor: '#000' }]}>
                        {/* Thumbnail Placeholder */}
                        <View style={styles.thumbnailPlaceholder}>
                            <Image
                                source={{ uri: videoUri }}
                                style={styles.thumbnailImage}
                                resizeMode="cover"
                            />
                            <View style={styles.playOverlay}>
                                <IconSymbol name="play.fill" size={30} color="#FFF" />
                            </View>
                        </View>

                        <TouchableOpacity style={[styles.removeButton, { backgroundColor: colors.red }]} onPress={removeVideo}>
                            <IconSymbol name="xmark" size={16} color="#FFF" />
                            <Text style={styles.removeText}>Remove</Text>
                        </TouchableOpacity>

                        <Text style={[styles.fileName, { color: colors.text }]}>Ready to upload</Text>
                    </View>
                )}
            </View>

            {/* FOOTER ACTION */}
            <View style={styles.footer}>
                {uploading ? (
                    <ActivityIndicator size="large" color={colors.navy} />
                ) : (
                    <TouchableOpacity
                        style={[styles.uploadButton, !videoUri && styles.disabledButton, { backgroundColor: !videoUri ? colors.border : colors.navy }]}
                        onPress={handleUpload}
                        disabled={!videoUri}
                    >
                        <Text style={[styles.buttonText, { color: !videoUri ? colors.text : '#FFF' }]}>Upload to Team</Text>
                    </TouchableOpacity>
                )}
            </View>
        </SafeAreaView>
    );
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
    },
    header: {
        paddingHorizontal: 20,
        paddingTop: 20,
        marginBottom: 20,
    },
    title: {
        fontSize: 34,
        fontWeight: '800',
    },
    subtitle: {
        fontSize: 16,
        marginTop: 5,
    },
    content: {
        flex: 1,
        paddingHorizontal: 20,
        justifyContent: 'center',
        alignItems: 'center', // Center the drop zone vertically in available space
    },
    // DROP ZONE
    dropZone: {
        width: '100%',
        height: 220,
        borderRadius: 20,
        borderWidth: 2,
        borderStyle: 'dashed',
        justifyContent: 'center',
        alignItems: 'center',
    },
    dropText: {
        marginTop: 15,
        fontSize: 18,
        fontWeight: '600',
    },
    dropSubText: {
        marginTop: 5,
    },
    // PREVIEW
    previewContainer: {
        width: '100%',
        borderRadius: 20,
        padding: 15,
        alignItems: 'center',
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.1,
        shadowRadius: 10,
        elevation: 5,
    },
    thumbnailPlaceholder: {
        width: '100%',
        height: 180,
        backgroundColor: '#000',
        borderRadius: 12,
        marginBottom: 15,
        justifyContent: 'center',
        alignItems: 'center',
        overflow: 'hidden',
    },
    thumbnailImage: {
        width: '100%',
        height: '100%',
        opacity: 0.7,
    },
    playOverlay: {
        position: 'absolute',
    },
    fileName: {
        fontSize: 16,
        fontWeight: '500',
        marginBottom: 5,
    },
    removeButton: {
        flexDirection: 'row',
        alignItems: 'center',
        paddingHorizontal: 12,
        paddingVertical: 6,
        borderRadius: 15,
        position: 'absolute',
        top: 25,
        right: 25,
    },
    removeText: {
        color: '#FFF',
        fontWeight: 'bold',
        marginLeft: 4,
        fontSize: 12,
    },
    // FOOTER
    footer: {
        padding: 20,
        paddingBottom: 40,
    },
    uploadButton: {
        height: 56,
        borderRadius: 28, // Fully rounded pill
        justifyContent: 'center',
        alignItems: 'center',
        shadowOffset: { width: 0, height: 4 },
        shadowOpacity: 0.3,
        shadowRadius: 8,
        elevation: 4,
    },
    disabledButton: {
        shadowOpacity: 0,
    },
    buttonText: {
        color: '#FFF',
        fontSize: 18,
        fontWeight: 'bold',
    },
});


========================================
FILE: constants/theme.ts
========================================
export const Colors = {
  light: {
    text: '#000000',
    background: '#F2F2F7',
    tint: '#003366',
    icon: '#687076',
    tabIconDefault: '#687076',
    tabIconSelected: '#003366',
    card: '#FFFFFF',
    border: '#E5E5EA',
    navy: '#003366',
    red: '#CC0000',
    glass: 'rgba(255, 255, 255, 0.95)',
  },
  dark: {
    text: '#FFFFFF',
    background: '#000000',
    tint: '#FFFFFF',
    icon: '#9BA1A6',
    tabIconDefault: '#9BA1A6',
    tabIconSelected: '#FFFFFF',
    card: '#1C1C1E',
    border: '#38383A',
    navy: '#003366', // Keep brand color but maybe adjust if needed, but requirements said "Keep them Navy Blue"
    red: '#CC0000',
    glass: 'rgba(28, 28, 30, 0.95)',
  },
};


========================================
FILE: components/AuthForm.tsx
========================================
import { useTheme } from '@/components/ThemeContext';
import { supabase } from '@/lib/supabase';
import React, { useState } from 'react';
import { ActivityIndicator, Alert, StyleSheet, Text, TextInput, TouchableOpacity, View } from 'react-native';

export default function AuthForm() {
    const { colors } = useTheme();
    const [email, setEmail] = useState('');
    const [password, setPassword] = useState('');
    const [loading, setLoading] = useState(false);

    const handleLogin = async () => {
        setLoading(true);
        const { error } = await supabase.auth.signInWithPassword({ email, password });
        if (error) Alert.alert('Login Error', error.message);
        setLoading(false);
    };

    const handleSignUp = async () => {
        setLoading(true);
        const { error } = await supabase.auth.signUp({ email, password });
        if (error) Alert.alert('Sign Up Error', error.message);
        else Alert.alert('Success', 'Check your email for confirmation!');
        setLoading(false);
    };

    return (
        <View style={styles.container}>
            <TextInput
                style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}
                placeholder="Email"
                placeholderTextColor={colors.icon}
                value={email}
                onChangeText={setEmail}
                autoCapitalize="none"
            />
            <TextInput
                style={[styles.input, { backgroundColor: colors.card, color: colors.text, borderColor: colors.border }]}
                placeholder="Password"
                placeholderTextColor={colors.icon}
                value={password}
                onChangeText={setPassword}
                secureTextEntry
            />

            {loading ? (
                <ActivityIndicator size="large" color={colors.navy} />
            ) : (
                <View style={styles.buttons}>
                    <TouchableOpacity style={[styles.primaryButton, { backgroundColor: colors.navy }]} onPress={handleLogin}>
                        <Text style={styles.buttonText}>Log In</Text>
                    </TouchableOpacity>
                    <TouchableOpacity style={styles.secondaryButton} onPress={handleSignUp}>
                        <Text style={[styles.secondaryButtonText, { color: colors.text }]}>Sign Up</Text>
                    </TouchableOpacity>
                </View>
            )}
        </View>
    );
}

const styles = StyleSheet.create({
    container: {
        width: '100%',
        maxWidth: 400,
        alignSelf: 'center',
    },
    input: {
        height: 50,
        borderRadius: 12,
        borderWidth: 1,
        paddingHorizontal: 15,
        marginBottom: 15,
        fontSize: 16,
    },
    buttons: {
        marginTop: 10,
        gap: 15,
    },
    primaryButton: {
        height: 50,
        borderRadius: 12,
        justifyContent: 'center',
        alignItems: 'center',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.2,
        shadowRadius: 4,
        elevation: 2,
    },
    buttonText: {
        color: '#FFF',
        fontSize: 16,
        fontWeight: 'bold',
    },
    secondaryButton: {
        height: 50,
        justifyContent: 'center',
        alignItems: 'center',
    },
    secondaryButtonText: {
        fontSize: 16,
        fontWeight: '600',
    },
});


========================================
FILE: components/external-link.tsx
========================================
import { Href, Link } from 'expo-router';
import { openBrowserAsync, WebBrowserPresentationStyle } from 'expo-web-browser';
import { type ComponentProps } from 'react';

type Props = Omit<ComponentProps<typeof Link>, 'href'> & { href: Href & string };

export function ExternalLink({ href, ...rest }: Props) {
  return (
    <Link
      target="_blank"
      {...rest}
      href={href}
      onPress={async (event) => {
        if (process.env.EXPO_OS !== 'web') {
          // Prevent the default behavior of linking to the default browser on native.
          event.preventDefault();
          // Open the link in an in-app browser.
          await openBrowserAsync(href, {
            presentationStyle: WebBrowserPresentationStyle.AUTOMATIC,
          });
        }
      }}
    />
  );
}


========================================
FILE: components/haptic-tab.tsx
========================================
import { BottomTabBarButtonProps } from '@react-navigation/bottom-tabs';
import { PlatformPressable } from '@react-navigation/elements';
import * as Haptics from 'expo-haptics';

export function HapticTab(props: BottomTabBarButtonProps) {
  return (
    <PlatformPressable
      {...props}
      onPressIn={(ev) => {
        if (process.env.EXPO_OS === 'ios') {
          // Add a soft haptic feedback when pressing down on the tabs.
          Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
        }
        props.onPressIn?.(ev);
      }}
    />
  );
}


========================================
FILE: components/hello-wave.tsx
========================================
import Animated from 'react-native-reanimated';

export function HelloWave() {
  return (
    <Animated.Text
      style={{
        fontSize: 28,
        lineHeight: 32,
        marginTop: -6,
        animationName: {
          '50%': { transform: [{ rotate: '25deg' }] },
        },
        animationIterationCount: 4,
        animationDuration: '300ms',
      }}>
      ðŸ‘‹
    </Animated.Text>
  );
}


========================================
FILE: components/parallax-scroll-view.tsx
========================================
import type { PropsWithChildren, ReactElement } from 'react';
import { StyleSheet } from 'react-native';
import Animated, {
  interpolate,
  useAnimatedRef,
  useAnimatedStyle,
  useScrollOffset,
} from 'react-native-reanimated';

import { ThemedView } from '@/components/themed-view';
import { useColorScheme } from '@/hooks/use-color-scheme';
import { useThemeColor } from '@/hooks/use-theme-color';

const HEADER_HEIGHT = 250;

type Props = PropsWithChildren<{
  headerImage: ReactElement;
  headerBackgroundColor: { dark: string; light: string };
}>;

export default function ParallaxScrollView({
  children,
  headerImage,
  headerBackgroundColor,
}: Props) {
  const backgroundColor = useThemeColor({}, 'background');
  const colorScheme = useColorScheme() ?? 'light';
  const scrollRef = useAnimatedRef<Animated.ScrollView>();
  const scrollOffset = useScrollOffset(scrollRef);
  const headerAnimatedStyle = useAnimatedStyle(() => {
    return {
      transform: [
        {
          translateY: interpolate(
            scrollOffset.value,
            [-HEADER_HEIGHT, 0, HEADER_HEIGHT],
            [-HEADER_HEIGHT / 2, 0, HEADER_HEIGHT * 0.75]
          ),
        },
        {
          scale: interpolate(scrollOffset.value, [-HEADER_HEIGHT, 0, HEADER_HEIGHT], [2, 1, 1]),
        },
      ],
    };
  });

  return (
    <Animated.ScrollView
      ref={scrollRef}
      style={{ backgroundColor, flex: 1 }}
      scrollEventThrottle={16}>
      <Animated.View
        style={[
          styles.header,
          { backgroundColor: headerBackgroundColor[colorScheme] },
          headerAnimatedStyle,
        ]}>
        {headerImage}
      </Animated.View>
      <ThemedView style={styles.content}>{children}</ThemedView>
    </Animated.ScrollView>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
  },
  header: {
    height: HEADER_HEIGHT,
    overflow: 'hidden',
  },
  content: {
    flex: 1,
    padding: 32,
    gap: 16,
    overflow: 'hidden',
  },
});


========================================
FILE: components/ThemeContext.tsx
========================================
import { Colors } from '@/constants/theme';
import AsyncStorage from '@react-native-async-storage/async-storage';
import React, { createContext, useContext, useEffect, useState } from 'react';
import { useColorScheme } from 'react-native';

type ThemeType = 'light' | 'dark' | 'system';

interface ThemeContextType {
    theme: ThemeType;
    setTheme: (theme: ThemeType) => void;
    colors: typeof Colors.light;
    isDark: boolean;
}

const ThemeContext = createContext<ThemeContextType>({
    theme: 'system',
    setTheme: () => { },
    colors: Colors.light,
    isDark: false,
});

export const ThemeProvider = ({ children }: { children: React.ReactNode }) => {
    const systemScheme = useColorScheme();
    const [theme, setTheme] = useState<ThemeType>('system');

    useEffect(() => {
        // Load persisted theme
        AsyncStorage.getItem('user_theme').then((saved: string | null) => {
            if (saved) setTheme(saved as ThemeType);
        });
    }, []);

    const saveTheme = (newTheme: ThemeType) => {
        setTheme(newTheme);
        AsyncStorage.setItem('user_theme', newTheme);
    };

    const activeScheme = theme === 'system' ? systemScheme : theme;
    const isDark = activeScheme === 'dark';
    const colors = isDark ? Colors.dark : Colors.light;

    return (
        <ThemeContext.Provider value={{ theme, setTheme: saveTheme, colors, isDark }}>
            {children}
        </ThemeContext.Provider>
    );
};

export const useTheme = () => useContext(ThemeContext);


========================================
FILE: components/themed-text.tsx
========================================
import { StyleSheet, Text, type TextProps } from 'react-native';

import { useThemeColor } from '@/hooks/use-theme-color';

export type ThemedTextProps = TextProps & {
  lightColor?: string;
  darkColor?: string;
  type?: 'default' | 'title' | 'defaultSemiBold' | 'subtitle' | 'link';
};

export function ThemedText({
  style,
  lightColor,
  darkColor,
  type = 'default',
  ...rest
}: ThemedTextProps) {
  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');

  return (
    <Text
      style={[
        { color },
        type === 'default' ? styles.default : undefined,
        type === 'title' ? styles.title : undefined,
        type === 'defaultSemiBold' ? styles.defaultSemiBold : undefined,
        type === 'subtitle' ? styles.subtitle : undefined,
        type === 'link' ? styles.link : undefined,
        style,
      ]}
      {...rest}
    />
  );
}

const styles = StyleSheet.create({
  default: {
    fontSize: 16,
    lineHeight: 24,
  },
  defaultSemiBold: {
    fontSize: 16,
    lineHeight: 24,
    fontWeight: '600',
  },
  title: {
    fontSize: 32,
    fontWeight: 'bold',
    lineHeight: 32,
  },
  subtitle: {
    fontSize: 20,
    fontWeight: 'bold',
  },
  link: {
    lineHeight: 30,
    fontSize: 16,
    color: '#0a7ea4',
  },
});


========================================
FILE: components/themed-view.tsx
========================================
import { View, type ViewProps } from 'react-native';

import { useThemeColor } from '@/hooks/use-theme-color';

export type ThemedViewProps = ViewProps & {
  lightColor?: string;
  darkColor?: string;
};

export function ThemedView({ style, lightColor, darkColor, ...otherProps }: ThemedViewProps) {
  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');

  return <View style={[{ backgroundColor }, style]} {...otherProps} />;
}


========================================
FILE: components/ui/collapsible.tsx
========================================
import { PropsWithChildren, useState } from 'react';
import { StyleSheet, TouchableOpacity } from 'react-native';

import { ThemedText } from '@/components/themed-text';
import { ThemedView } from '@/components/themed-view';
import { IconSymbol } from '@/components/ui/icon-symbol';
import { Colors } from '@/constants/theme';
import { useColorScheme } from '@/hooks/use-color-scheme';

export function Collapsible({ children, title }: PropsWithChildren & { title: string }) {
  const [isOpen, setIsOpen] = useState(false);
  const theme = useColorScheme() ?? 'light';

  return (
    <ThemedView>
      <TouchableOpacity
        style={styles.heading}
        onPress={() => setIsOpen((value) => !value)}
        activeOpacity={0.8}>
        <IconSymbol
          name="chevron.right"
          size={18}
          weight="medium"
          color={theme === 'light' ? Colors.light.icon : Colors.dark.icon}
          style={{ transform: [{ rotate: isOpen ? '90deg' : '0deg' }] }}
        />

        <ThemedText type="defaultSemiBold">{title}</ThemedText>
      </TouchableOpacity>
      {isOpen && <ThemedView style={styles.content}>{children}</ThemedView>}
    </ThemedView>
  );
}

const styles = StyleSheet.create({
  heading: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 6,
  },
  content: {
    marginTop: 6,
    marginLeft: 24,
  },
});


========================================
FILE: components/ui/icon-symbol.tsx
========================================
// Fallback for using MaterialIcons on Android and web.

import MaterialIcons from '@expo/vector-icons/MaterialIcons';
import { SymbolWeight } from 'expo-symbols';
import { ComponentProps } from 'react';
import { OpaqueColorValue, type StyleProp, type TextStyle } from 'react-native';

// Allow any string key to avoid strict SF Symbol type checking issues during development
type IconMapping = Record<string, ComponentProps<typeof MaterialIcons>['name']>;

export type IconSymbolName = keyof typeof MAPPING;

/**
 * Add your SF Symbols to Material Icons mappings here.
 * - see Material Icons in the [Icons Directory](https://icons.expo.fyi).
 * - see SF Symbols in the [SF Symbols](https://developer.apple.com/sf-symbols/) app.
 */
const MAPPING = {
  'house.fill': 'home',
  'paperplane.fill': 'send',
  'chevron.left.forwardslash.chevron.right': 'code',
  'chevron.right': 'chevron-right',
  'cloud.upload.fill': 'cloud-upload',
  'play.fill': 'play-arrow',
  'xmark': 'close',
  'map.fill': 'map',
  'video.fill': 'videocam',
  'video.slash': 'videocam-off',
  'arrow.up.doc.fill': 'upload-file',
  'person.fill': 'person',
} as IconMapping;

/**
 * An icon component that uses native SF Symbols on iOS, and Material Icons on Android and web.
 * This ensures a consistent look across platforms, and optimal resource usage.
 * Icon `name`s are based on SF Symbols and require manual mapping to Material Icons.
 */
export function IconSymbol({
  name,
  size = 24,
  color,
  style,
}: {
  name: IconSymbolName;
  size?: number;
  color: string | OpaqueColorValue;
  style?: StyleProp<TextStyle>;
  weight?: SymbolWeight;
}) {
  return <MaterialIcons color={color} size={size} name={MAPPING[name]} style={style} />;
}


========================================
FILE: hooks/use-color-scheme.ts
========================================
export { useColorScheme } from 'react-native';


========================================
FILE: hooks/use-color-scheme.web.ts
========================================
import { useEffect, useState } from 'react';
import { useColorScheme as useRNColorScheme } from 'react-native';

/**
 * To support static rendering, this value needs to be re-calculated on the client side for web
 */
export function useColorScheme() {
  const [hasHydrated, setHasHydrated] = useState(false);

  useEffect(() => {
    setHasHydrated(true);
  }, []);

  const colorScheme = useRNColorScheme();

  if (hasHydrated) {
    return colorScheme;
  }

  return 'light';
}


========================================
FILE: hooks/use-theme-color.ts
========================================
/**
 * Learn more about light and dark modes:
 * https://docs.expo.dev/guides/color-schemes/
 */

import { Colors } from '@/constants/theme';
import { useColorScheme } from '@/hooks/use-color-scheme';

export function useThemeColor(
  props: { light?: string; dark?: string },
  colorName: keyof typeof Colors.light & keyof typeof Colors.dark
) {
  const theme = useColorScheme() ?? 'light';
  const colorFromProps = props[theme];

  if (colorFromProps) {
    return colorFromProps;
  } else {
    return Colors[theme][colorName];
  }
}


========================================
FILE: scripts/reset-project.js
========================================
#!/usr/bin/env node

/**
 * This script is used to reset the project to a blank state.
 * It deletes or moves the /app, /components, /hooks, /scripts, and /constants directories to /app-example based on user input and creates a new /app directory with an index.tsx and _layout.tsx file.
 * You can remove the `reset-project` script from package.json and safely delete this file after running it.
 */

const fs = require("fs");
const path = require("path");
const readline = require("readline");

const root = process.cwd();
const oldDirs = ["app", "components", "hooks", "constants", "scripts"];
const exampleDir = "app-example";
const newAppDir = "app";
const exampleDirPath = path.join(root, exampleDir);

const indexContent = `import { Text, View } from "react-native";

export default function Index() {
  return (
    <View
      style={{
        flex: 1,
        justifyContent: "center",
        alignItems: "center",
      }}
    >
      <Text>Edit app/index.tsx to edit this screen.</Text>
    </View>
  );
}
`;

const layoutContent = `import { Stack } from "expo-router";

export default function RootLayout() {
  return <Stack />;
}
`;

const rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});

const moveDirectories = async (userInput) => {
  try {
    if (userInput === "y") {
      // Create the app-example directory
      await fs.promises.mkdir(exampleDirPath, { recursive: true });
      console.log(`ðŸ“ /${exampleDir} directory created.`);
    }

    // Move old directories to new app-example directory or delete them
    for (const dir of oldDirs) {
      const oldDirPath = path.join(root, dir);
      if (fs.existsSync(oldDirPath)) {
        if (userInput === "y") {
          const newDirPath = path.join(root, exampleDir, dir);
          await fs.promises.rename(oldDirPath, newDirPath);
          console.log(`âž¡ï¸ /${dir} moved to /${exampleDir}/${dir}.`);
        } else {
          await fs.promises.rm(oldDirPath, { recursive: true, force: true });
          console.log(`âŒ /${dir} deleted.`);
        }
      } else {
        console.log(`âž¡ï¸ /${dir} does not exist, skipping.`);
      }
    }

    // Create new /app directory
    const newAppDirPath = path.join(root, newAppDir);
    await fs.promises.mkdir(newAppDirPath, { recursive: true });
    console.log("\nðŸ“ New /app directory created.");

    // Create index.tsx
    const indexPath = path.join(newAppDirPath, "index.tsx");
    await fs.promises.writeFile(indexPath, indexContent);
    console.log("ðŸ“„ app/index.tsx created.");

    // Create _layout.tsx
    const layoutPath = path.join(newAppDirPath, "_layout.tsx");
    await fs.promises.writeFile(layoutPath, layoutContent);
    console.log("ðŸ“„ app/_layout.tsx created.");

    console.log("\nâœ… Project reset complete. Next steps:");
    console.log(
      `1. Run \`npx expo start\` to start a development server.\n2. Edit app/index.tsx to edit the main screen.${
        userInput === "y"
          ? `\n3. Delete the /${exampleDir} directory when you're done referencing it.`
          : ""
      }`
    );
  } catch (error) {
    console.error(`âŒ Error during script execution: ${error.message}`);
  }
};

rl.question(
  "Do you want to move existing files to /app-example instead of deleting them? (Y/n): ",
  (answer) => {
    const userInput = answer.trim().toLowerCase() || "y";
    if (userInput === "y" || userInput === "n") {
      moveDirectories(userInput).finally(() => rl.close());
    } else {
      console.log("âŒ Invalid input. Please enter 'Y' or 'N'.");
      rl.close();
    }
  }
);


========================================
FILE: lib/supabase.ts
========================================
import { createClient } from '@supabase/supabase-js';
import * as SecureStore from 'expo-secure-store';
import 'react-native-url-polyfill/auto';

// Custom storage adapter using SecureStore for web/native compatibility if needed, 
// using AsyncStorage as requested for generic persistence or specific SecureStore adapter.
// The user prompt specifically asked for "expo-secure-store to persist user sessions".

const ExpoSecureStoreAdapter = {
    getItem: (key: string) => {
        return SecureStore.getItemAsync(key);
    },
    setItem: (key: string, value: string) => {
        SecureStore.setItemAsync(key, value);
    },
    removeItem: (key: string) => {
        SecureStore.deleteItemAsync(key);
    },
};

const supabaseUrl = process.env.EXPO_PUBLIC_SUPABASE_URL || 'https://YOUR_PROJECT_ID.supabase.co';
const supabaseAnonKey = process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY || 'YOUR_ANON_KEY';

export const supabase = createClient(supabaseUrl, supabaseAnonKey, {
    auth: {
        storage: ExpoSecureStoreAdapter as any,
        autoRefreshToken: true,
        persistSession: true,
        detectSessionInUrl: false,
    },
});

